<div class="flex items-center justify-center gap-6 rounded-full bg-gray-50 py-2 px-4 border border-gray-200">
  @if(isResubmitMode()){
  <!-- Resubmit mode: Show Add/Edit comment button without checkboxes -->
  @if(commentPhase() === 'viewing'){
  <p-button
    label="Edit Comment"
    variant="outlined"
    icon="icon-edit"
    rounded
    styleClass="border-0! bg-white!"
    (click)="onStartEditingResubmitMode()"
  />
  } @else if(!hasInvestorComment() && commentPhase() === 'none'){
  <p-button
    label="Add Comment"
    severity="warn"
    icon="icon-message-circle"
    rounded
    (click)="commentPhase.set('adding'); showCommentDialog.set(true)"
  />
  } @else if(commentPhase() === 'adding' || commentPhase() === 'editing'){
  <p-button
    label="Save Comment"
    severity="warn"
    icon="icon-check-circle"
    rounded
    [disabled]="commentFormControl().invalid"
    (click)="onSaveComment()"
  />
  }
  } @else {
  <!-- Normal mode: Show full comment state with checkboxes -->
  @if(commentPhase() === 'viewing'){
  <p-button
    label="Edit"
    variant="outlined"
    icon="icon-edit"
    rounded
    styleClass="border-0! bg-white!"
    (click)="onStartEditing()"
  />

  <p-button
    label="Delete Comment"
    severity="danger"
    icon="icon-trash-2"
    rounded
    variant="outlined"
    styleClass="bg-white!"
    (click)="onDeleteComments()"
  />
  }
  @else if(commentPhase() === 'adding' || commentPhase() === 'editing'){
  @if(mode() === 'fieldSelection'){
  <div class="flex items-center gap-2">
    <p-checkbox
      [class.p-checkbox-orange]="checked()"
      [(ngModel)]="checked"
      [binary]="true"
      [disabled]="true"
    />
    <span class="text-md font-semibold text-gray-600">{{ commentsCount() }} Selected</span>
  </div>
  }
  @if(commentPhase() === 'adding'){
  <p-button
    label="Add Comment"
    severity="warn"
    icon="icon-message-circle"
    rounded
    [disabled]="mode() === 'fieldSelection' && !checked()"
    (click)="showCommentDialog.set(true)"
  />
  }@else{
  <p-button
    label="Save Comment"
    severity="warn"
    icon="icon-check-circle"
    rounded
    [disabled]="commentFormControl().invalid || (mode() === 'fieldSelection' && !checked())"
    (click)="onSaveComment()"
  />
  }
  }
  }
</div>
<app-comment-dialog
  [(visible)]="showCommentDialog"
  [commentFormControl]="commentFormControl()"
  (commentAdded)="onCommentAdded()"
></app-comment-dialog>
