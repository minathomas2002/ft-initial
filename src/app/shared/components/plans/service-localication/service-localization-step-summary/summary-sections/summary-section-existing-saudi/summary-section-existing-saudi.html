<div class="flex flex-col gap-6 bg-white">
  <!-- Section Header -->
  <div class="flex flex-col gap-4">
    <app-summary-section-header
      [title]="'Existing Saudi Co.'"
      [isViewMode]="isViewMode()"
      (onEdit)="onEditClick()"
    />

    <!-- Saudi Company Details -->
    <div class="flex flex-col gap-4">
      <h3 class="text-lg font-semibold text-[#4A4E5A]">Saudi Company Details</h3>
        <div class="overflow-x-auto">
          <div class="rounded-lg overflow-hidden border border-gray-300">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-[#F9FAFA]">
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Saudi Company Name</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Vendor ID with SEC</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Bena Vendor ID</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Company Type</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Qualification Status</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Product(s)</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Company Overview</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Key Projects Executed</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Company Overview Key Project Details</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Company Overview (Other)</th>
                </tr>
              </thead>
              <tbody>
                @for (company of saudiCompanyDetails(); track $index) {
                  <tr>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.saudiCompanyName"
                        [isEmpty]="!company.saudiCompanyName"
                        [hasError]="hasSaudiCompanyFieldError($index, 'saudiCompanyName')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.registeredVendorIDwithSEC"
                        [isEmpty]="!company.registeredVendorIDwithSEC"
                        [hasError]="hasSaudiCompanyFieldError($index, 'registeredVendorIDwithSEC')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.benaRegisteredVendorID"
                        [isEmpty]="!company.benaRegisteredVendorID"
                        [hasError]="hasSaudiCompanyFieldError($index, 'benaRegisteredVendorID')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="formatCompanyType(company.companyType)"
                        [isEmpty]="!formatCompanyType(company.companyType)"
                        [hasError]="hasSaudiCompanyFieldError($index, 'companyType')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="formatQualificationStatus(company.qualificationStatus)"
                        [isEmpty]="!formatQualificationStatus(company.qualificationStatus)"
                        [hasError]="hasSaudiCompanyFieldError($index, 'qualificationStatus')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.products"
                        [isEmpty]="!company.products"
                        [hasError]="hasSaudiCompanyFieldError($index, 'products')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.companyOverview"
                        [isEmpty]="!company.companyOverview"
                        [hasError]="hasSaudiCompanyFieldError($index, 'companyOverview')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.keyProjectsExecutedByContractorForSEC"
                        [isEmpty]="!company.keyProjectsExecutedByContractorForSEC"
                        [hasError]="hasSaudiCompanyFieldError($index, 'keyProjectsExecutedByContractorForSEC')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.companyOverviewKeyProjectDetails"
                        [isEmpty]="!company.companyOverviewKeyProjectDetails"
                        [hasError]="hasSaudiCompanyFieldError($index, 'companyOverviewKeyProjectDetails')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="company.companyOverviewOther"
                        [isEmpty]="!company.companyOverviewOther"
                        [hasError]="hasSaudiCompanyFieldError($index, 'companyOverviewOther')"
                      />
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>

    </div>

    <!-- Collaboration/Partnership -->
    <div class="flex flex-col gap-4">
      <h3 class="text-lg font-semibold text-[#4A4E5A]">Details on Collaboration / Partnership model</h3>
        <div class="overflow-x-auto">
          <div class="rounded-lg overflow-hidden border border-gray-300">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-[#F9FAFA]">
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Agreement Type</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">If Agreement Type is "Other", provide details</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Agreement Signing Date</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Supervision/Oversight Entity</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Why Chose This Company</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Summary of Key Agreement Clauses</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]">Provide Agreement Copy</th>
                </tr>
              </thead>
              <tbody>
                @for (partner of collaborationPartnership(); track $index) {
                  <tr>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.agreementType"
                        [isEmpty]="!partner.agreementType"
                        [hasError]="hasCollaborationFieldError($index, 'agreementType')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.agreementOtherDetails"
                        [isEmpty]="!partner.agreementOtherDetails"
                        [hasError]="hasCollaborationFieldError($index, 'agreementOtherDetails')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.agreementSigningDate"
                        [isEmpty]="!partner.agreementSigningDate"
                        [hasError]="hasCollaborationFieldError($index, 'agreementSigningDate')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.supervisionOversight"
                        [isEmpty]="!partner.supervisionOversight"
                        [hasError]="hasCollaborationFieldError($index, 'supervisionOversightEntity')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.whyChoseThisCompany"
                        [isEmpty]="!partner.whyChoseThisCompany"
                        [hasError]="hasCollaborationFieldError($index, 'whyChoseThisCompany')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.summaryOfKeyAgreementClauses"
                        [isEmpty]="!partner.summaryOfKeyAgreementClauses"
                        [hasError]="hasCollaborationFieldError($index, 'summaryOfKeyAgreementClauses')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="partner.provideAgreementCopy"
                        [isEmpty]="partner.provideAgreementCopy === null || partner.provideAgreementCopy === undefined"
                        [hasError]="hasCollaborationFieldError($index, 'provideAgreementCopy')"
                      />
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
    </div>

    <!-- Entity Level -->
    @if (entityLevel()) {
      <div class="flex flex-col gap-4">
        <h3 class="text-lg font-semibold text-[#4A4E5A]">Entity Level (i.e., local conpany responsible for delivering the services)</h3>
        <p class="text-sm font-normal text-[#4A4E5A]">Details to be provided for the KSA facility only considering only the workforce / employees directly responsible for delivering all the services you intend to localize by setting up local entity / branch / other</p>
        <div class="overflow-x-auto">
          <div class="rounded-lg overflow-hidden border border-gray-300">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-primary">
                  <th class="p-3 text-start text-sm font-medium text-white" colspan="5">Expected Annual Headcount (upto 2030) <span class="font-normal text-xs">(To be filled for the KSA based facility only)</span></th>
                </tr>
                <tr class="bg-[#F9FAFA]">
                  @for (year of yearColumns(); track $index) {
                    <th class="p-3 text-start text-sm font-medium text-[#4A4E5A]">{{ year }}</th>
                  }
                </tr>
              </thead>
              <tbody>
                <tr>
                  @for (headcount of entityLevel()!.headcount; track $index) {
                    <td class="border-t border-gray-300 p-3 text-center">
                      <app-summary-table-cell
                        [value]="headcount"
                        [isEmpty]="!headcount && headcount !== 0"
                      />
                    </td>
                  }
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    }

    <!-- Service Level -->
    <div class="flex flex-col gap-4">
      <h3 class="text-lg font-semibold text-[#4A4E5A]">Service Level</h3>
      @if (serviceLevel().length > 0) {
        <div class="overflow-x-auto">
          <div class="rounded-lg overflow-hidden border border-gray-300">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-[#F9FAFA]">
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]" rowspan="2">Service Name</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]" rowspan="2">Expected Localization Date</th>
                  <th class="p-3 text-center text-sm font-semibold text-white bg-primary" colspan="5">Mention Y-o-Y expected Saudization % (To be filled for the KSA based facility only)</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]" rowspan="2">Key Measures to Upskill Saudis</th>
                  <th class="p-3 text-left text-sm font-semibold text-[#4A4E5A]" rowspan="2">Support Required from SEC</th>
                </tr>
                <tr class="bg-[#F9FAFA]">
                  @for (year of yearColumns(); track $index) {
                    <th class="p-3 text-center text-sm font-semibold text-[#4A4E5A]">{{ year }}</th>
                  }
                </tr>
              </thead>
              <tbody>
                @for (service of serviceLevel(); track $index) {
                  <tr>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="service.serviceName"
                        [isEmpty]="!service.serviceName"
                        [hasError]="hasServiceLevelFieldError(service.index, 'serviceName')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="service.expectedLocalizationDate"
                        [isEmpty]="!service.expectedLocalizationDate"
                        [hasError]="hasServiceLevelFieldError(service.index, 'expectedLocalizationDate')"
                      />
                    </td>
                    @for (year of service.years; track $index) {
                      <td class="border-t border-gray-300 p-3 text-center">
                        <app-summary-table-cell
                          [value]="year.value"
                          [isEmpty]="!year.value && year.value !== 0"
                          [hasError]="hasServiceLevelFieldError(service.index, year.controlName)"
                        />
                      </td>
                    }
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="service.keyMeasuresToUpskillSaudis"
                        [isEmpty]="!service.keyMeasuresToUpskillSaudis"
                        [hasError]="hasServiceLevelFieldError(service.index, 'keyMeasuresToUpskillSaudis')"
                      />
                    </td>
                    <td class="border-t border-gray-300 p-3">
                      <app-summary-table-cell
                        [value]="service.mentionSupportRequiredFromSEC"
                        [isEmpty]="!service.mentionSupportRequiredFromSEC"
                        [hasError]="hasServiceLevelFieldError(service.index, 'mentionSupportRequiredFromSEC')"
                      />
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      } @else {
        <p class="text-sm text-gray-500">No service level details added</p>
      }
    </div>
  </div>
</div>
