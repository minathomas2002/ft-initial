<div class="flex flex-col gap-8">
  <!-- Step 1: Cover Page -->
  @if (shouldShowIncomingComments() && hasIncomingStep1Comments()) {
  <app-page-comment-box
    [commentTitle]="incomingCommentPersona() || 'Comment'"
    [commentText]="getIncomingStep1CommentText()"
  />
  }
  <app-summary-section-cover-page
    [isViewMode]="isViewMode()"
    [formGroup]="step1FormGroup"
    [pageComments]="step1CommentsComputed()"
    [commentTitle]="commentTitle()"
    [correctedFieldIds]="step1CorrectedFields()"
    (onEdit)="onEditStepClick(coverStepNumber())"
  />
  @if (hasStep1OutComingComments()) {
  <app-page-comment-box
    [commentTitle]="'Your Comment' + ' - Cover Page'"
    [commentText]="getStep1CommentText()"
  />
  }

  <!-- Step 2: Overview & Company Information -->
  @if (shouldShowIncomingComments() && hasIncomingStep2Comments()) {
  <app-page-comment-box
    [commentTitle]="incomingCommentPersona() || 'Comment'"
    [commentText]="getIncomingStep2CommentText()"
  />
  }
  <app-summary-section-overview
    [isViewMode]="isViewMode()"
    [formGroup]="step2FormGroup"
    [pageComments]="step2CommentsComputed()"
    [commentTitle]="commentTitle()"
    [correctedFieldIds]="step2CorrectedFields()"
    (onEdit)="onEditStepClick(overviewStepNumber())"
  />
  @if (hasStep2OutComingComments()) {
  <app-page-comment-box
    [commentTitle]="'Your Comment' + ' - Overview'"
    [commentText]="getStep2CommentText()"
  />
  }

  <!-- Step 3: Existing Saudi Company -->
  @if (includeExistingSaudi()) {
  @if (shouldShowIncomingComments() && hasIncomingStep3Comments()) {
  <app-page-comment-box
    [commentTitle]="incomingCommentPersona() || 'Comment'"
    [commentText]="getIncomingStep3CommentText()"
  />
  }
  <app-summary-section-existing-saudi
    [isViewMode]="isViewMode()"
    [formGroup]="step3FormGroup"
    [pageComments]="step3CommentsComputed()"
    [commentTitle]="commentTitle()"
    [correctedFieldIds]="step3CorrectedFields()"
    (onEdit)="onEditStepClick(existingSaudiStepNumber())"
  />
  @if (hasStep3OutComingComments()) {
  <app-page-comment-box
    [commentTitle]="'Your Comment' + ' - Existing Saudi Co.'"
    [commentText]="getStep3CommentText()"
  />
  }
  }

  <!-- Step 4: Direct Localization by Foreign Entity -->
  @if (includeDirectLocalization()) {
  @if (shouldShowIncomingComments() && hasIncomingStep4Comments()) {
  <app-page-comment-box
    [commentTitle]="incomingCommentPersona() || 'Comment'"
    [commentText]="getIncomingStep4CommentText()"
  />
  }
  <app-summary-section-direct-localization
    [isViewMode]="isViewMode()"
    [formGroup]="step4FormGroup"
    [pageComments]="step4CommentsComputed()"
    [commentTitle]="commentTitle()"
    [correctedFieldIds]="step4CorrectedFields()"
    (onEdit)="onEditStepClick(directLocalizationStepNumber())"
  />
  @if (hasStep4OutComingComments()) {
  <app-page-comment-box
    [commentTitle]="'Your Comment' + ' - Direct Localization'"
    [commentText]="getStep4CommentText()"
  />
  }
  }

  <!-- Signature (view/edit modes) -->
  @if (signature() && isViewMode()) {
  <app-summary-section-signature [signature]="signature()" />
  }
</div>