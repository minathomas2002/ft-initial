<app-base-wizard-dialog
  [(visible)]="visibility"
  [(activeStep)]="activeStep"
  [steps]="steps()"
  [wizardTitle]="wizardTitle()"
  (onNextStep)="nextStep()"
  (onPreviousStep)="previousStep()"
  (onSaveAsDraft)="saveAsDraft()"
  [isLoading]="isLoading() || isLoadingPlan()"
  [isProcessing]="isProcessing()"
  [hideSaveAsDraft]="isViewMode()"
  (onClose)="onClose()"
>

  <ng-container ngProjectAs="status">
    <app-base-tag
      [color]="'gray'"
      [value]="'Draft'"
    />
  </ng-container>

  <ng-template [appStepContent]="1">
    <app-step-01-overview-company-information-form />
  </ng-template>

  <ng-template [appStepContent]="2">
    <app-step-02-product-plant-overview-form />
  </ng-template>

  <ng-template [appStepContent]="3">
    <app-step-03-valueChain-form />
  </ng-template>

  <ng-template [appStepContent]="4">
    <app-step-04-saudization-form />
  </ng-template>

  <ng-template [appStepContent]="5">
    <app-step-05-summary
      #summaryComponent
      (onEditStep)="navigateToStep($event)"
      (onSubmit)="handleSubmit()"
      (onValidationErrorsChange)="updateValidationErrors($event)"
    />
  </ng-template>

  <ng-container ngProjectAs="final-step-action">
    @if (activeStep() === 5 && !isViewMode()) {
    <p-button
      [label]="'Submit'"
      (click)="onSummarySubmitClick()"
    ></p-button>
    }
  </ng-container>
</app-base-wizard-dialog>

<!-- Submission Confirmation Modal -->
<app-submission-confirmation-modal
  [(visible)]="showSubmissionModal"
  [(existingSignature)]="existingSignature"
  (onConfirm)="onSubmissionConfirm($event)"
  (onCancel)="onSubmissionCancel()"
/>

<!-- Confirm Leave Dialog -->
<app-confirm-leave-dialog
  [(visible)]="showConfirmLeaveDialog"
  (onLeave)="onConfirmLeave()"
  (onContinueEditing)="onContinueEditing()"
/>