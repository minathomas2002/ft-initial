<div class="px-8 flex flex-col gap-8 pb-10">
  <!-- Localization -->
  <div>
    <h3 class="text-lg font-semibold mb-4">{{ 'opportunity.form.localization' | translate }}</h3>
    <div class="flex flex-col gap-4">
      <!-- Design & Engineering -->
      <div class="flex flex-col gap-2">
        <app-base-label [title]="'opportunity.form.designEngineering' | translate">
        </app-base-label>
        <app-form-array-input
          [ft]="getFormArray('designEngineerings')"
          [addButtonMessage]="'opportunity.form.addDesignEngineeringItem' | translate"
          [maxItems]="10"
          [createNewItem]="createKeyActivityControl"
        >
          <ng-template
            #itemTemplate
            let-itemControl
            let-index="index"
          >
            <td class="p-3 border border-gray-200">
              <input
                type="text"
                pInputText
                class="w-full"
                [placeholder]="'opportunity.form.enterKeyActivities' | translate"
                [formControl]="getKeyActivityControl(itemControl)!"
                (blur)="getKeyActivityControl(itemControl)?.markAsTouched()"
              />
            </td>
          </ng-template>
        </app-form-array-input>
        @if(getFormArray('designEngineerings').invalid && getFormArray('designEngineerings').dirty){
        <small class="text-red-500">
          {{ 'opportunity.form.designEngineeringRequired' | translate }}
        </small>
        }
      </div>

      <!-- Sourcing -->
      <div class="flex flex-col gap-2">
        <app-base-label [title]="'opportunity.form.sourcing' | translate">
        </app-base-label>
        <app-form-array-input
          [ft]="getFormArray('sourcings')"
          [addButtonMessage]="'opportunity.form.addSourcingItem' | translate"
          [maxItems]="10"
          [createNewItem]="createKeyActivityControl"
        >
          <ng-template
            #itemTemplate
            let-itemControl
            let-index="index"
          >
            <td class="p-3 border border-gray-200">
              <input
                type="text"
                pInputText
                class="w-full"
                [placeholder]="'opportunity.form.enterKeyActivities' | translate"
                [formControl]="getKeyActivityControl(itemControl)!"
                (blur)="getKeyActivityControl(itemControl)?.markAsTouched()"
              />
            </td>
          </ng-template>
        </app-form-array-input>
        @if(getFormArray('sourcings').invalid && getFormArray('sourcings').dirty){
        <small class="text-red-500">
          {{ 'opportunity.form.sourcingRequired' | translate }}
        </small>
        }
      </div>

      <!-- Manufacturing -->
      <div class="flex flex-col gap-2">
        <app-base-label [title]="'opportunity.form.manufacturing' | translate">
        </app-base-label>
        <app-form-array-input
          [ft]="getFormArray('manufacturings')"
          [addButtonMessage]="'opportunity.form.addManufacturingItem' | translate"
          [maxItems]="10"
          [createNewItem]="createKeyActivityControl"
        >
          <ng-template
            #itemTemplate
            let-itemControl
            let-index="index"
          >
            <td class="p-3 border border-gray-200">
              <input
                type="text"
                pInputText
                class="w-full"
                [placeholder]="'opportunity.form.enterKeyActivities' | translate"
                [formControl]="getKeyActivityControl(itemControl)!"
                (blur)="getKeyActivityControl(itemControl)?.markAsTouched()"
              />
            </td>
          </ng-template>
        </app-form-array-input>
        @if(getFormArray('manufacturings').invalid && getFormArray('manufacturings').dirty){
        <small class="text-red-500">
          {{ 'opportunity.form.manufacturingRequired' | translate }}
        </small>
        }
      </div>

      <!-- Assembly & Testing -->
      <div class="flex flex-col gap-2">
        <app-base-label [title]="'opportunity.form.assemblyTesting' | translate">
        </app-base-label>
        <app-form-array-input
          [ft]="getFormArray('assemblyTestings')"
          [addButtonMessage]="'opportunity.form.addAssemblyTestingItem' | translate"
          [maxItems]="10"
          [createNewItem]="createKeyActivityControl"
        >
          <ng-template
            #itemTemplate
            let-itemControl
            let-index="index"
          >
            <td class="p-3 border border-gray-200">
              <input
                type="text"
                pInputText
                class="w-full"
                [placeholder]="'opportunity.form.enterKeyActivities' | translate"
                [formControl]="getKeyActivityControl(itemControl)!"
                (blur)="getKeyActivityControl(itemControl)?.markAsTouched()"
              />
            </td>
          </ng-template>
        </app-form-array-input>
        @if(getFormArray('assemblyTestings').invalid && getFormArray('assemblyTestings').dirty){
        <small class="text-red-500">
          {{ 'opportunity.form.assemblyTestingRequired' | translate }}
        </small>
        }
      </div>

      <!-- After Sales Services -->
      <div class="flex flex-col gap-2">
        <app-base-label [title]="'opportunity.form.afterSalesServices' | translate">
        </app-base-label>
        <app-form-array-input
          [ft]="getFormArray('afterSalesServices')"
          [addButtonMessage]="'opportunity.form.addAfterSalesServicesItem' | translate"
          [maxItems]="10"
          [createNewItem]="createKeyActivityControl"
        >
          <ng-template
            #itemTemplate
            let-itemControl
            let-index="index"
          >
            <td class="p-3 border border-gray-200">
              <input
                type="text"
                pInputText
                class="w-full"
                [placeholder]="'opportunity.form.enterKeyActivities' | translate"
                [formControl]="getKeyActivityControl(itemControl)!"
                (blur)="getKeyActivityControl(itemControl)?.markAsTouched()"
              />
            </td>
          </ng-template>
        </app-form-array-input>
        @if(getFormArray('afterSalesServices').invalid && getFormArray('afterSalesServices').dirty){
        <small class="text-red-500">
          {{ 'opportunity.form.afterSalesServicesRequired' | translate }}
        </small>
        }
      </div>
    </div>
  </div>

</div>