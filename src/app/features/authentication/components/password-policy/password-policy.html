<app-base-label [title]="'auth.password' | translate"></app-base-label>

<input
  autocomplete="new-password"
  type="password"
  pInputText
  [formControl]="formControl()"
  [placeholder]="'auth.enterYourPassword' | translate"
  fluid
/>

@if(formControl().dirty) {
@if(formControl().errors?.['required']) {
<small class="text-red-500">
  {{ 'auth.passwordRequired' | translate }}
</small>
}@else {

<!-- Password Policy Checks -->
@if(formControl().invalid) {

<div class="mt-2">
  <!-- Min 8 characters -->
  <div [ngClass]="formControl().errors?.['minLength']?'text-red-600':'text-green-600'">
    @if(formControl().errors?.['minLength']) {
    <i class="icon-x-circle"></i>
    }@else {
    <i class="icon-check-circle"></i>
    }
    <small>
      {{ 'auth.passwordMinLength' | translate }}
    </small>
  </div>

  <!-- At least 1 uppercase -->
  <div [ngClass]="formControl().errors?.['uppercase']?'text-red-600':'text-green-600'">
    @if(formControl().errors?.['uppercase']) {
    <i class="icon-x-circle"></i>
    }@else {
    <i class="icon-check-circle"></i>
    }
    <small>
      {{ 'auth.passwordUppercase' | translate }}
    </small>
  </div>

  <!-- At least 1 lowercase -->
  <div [ngClass]="formControl().errors?.['lowercase']?'text-red-600':'text-green-600'">
    @if(formControl().errors?.['lowercase']) {
    <i class="icon-x-circle"></i>
    }@else {
    <i class="icon-check-circle"></i>
    }
    <small>
      {{ 'auth.passwordLowercase' | translate }}
    </small>
  </div>

  <!-- At least 1 number -->
  <div [ngClass]="formControl().errors?.['number']?'text-red-600':'text-green-600'">
    @if(formControl().errors?.['number']) {
    <i class="icon-x-circle"></i>
    }@else {
    <i class="icon-check-circle"></i>
    }
    <small>
      {{ 'auth.passwordNumber' | translate }}
    </small>
  </div>

  <!-- At least 1 special character -->
  <div [ngClass]="formControl().errors?.['specialChar']?'text-red-600':'text-green-600'">
    @if(formControl().errors?.['specialChar']) {
    <i class="icon-x-circle"></i>
    }@else {
    <i class="icon-check-circle"></i>
    }
    <small>
      {{ 'auth.passwordSpecialChar' | translate }}
    </small>
  </div>
</div>
}
}
}
